# -*- coding: utf-8 -*-
"""Aula 02 - Exerc Prop - Representação de Características Textuais

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eEWDEhB4BkUWiETMKXsJt42wFGu7XdEB

![logo-home-copy-496x80a-red.png](data:image/png;base64,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)

# **Exercício Prático**

Esse notebook visa explorar diferentes representações de palavras através da utilização de algoritmos e modelos já bastante estabelecidos na comunidade de Processamento de Linguagem Natural.

Com a conclusão deste notebook vocês deverão estar aptos a:
*   Carregar diferentes modelos pré-treinados de representação de palavras
*   Visualizar a representação de palavras em um plano cartesiano
*   Treinar algoritmos existentes de representação de palavras para aprender o contexto das palavras em algum outro corpus específico.
*   Utilizar essas representações de palavras para treinar uma rede neural

# Carregando modelos de representação de palavras pré-treinados

A biblioteca [Gensim](https://radimrehurek.com/gensim/) é utilizada para obtenção da representação de documentos em linguagem natural. O Gensim apresenta uma grande variedade de modelos pré-treinados que podem ser utilizados sem qualquer esforço para codificar textos em  linguagem natural.

Nesse exercício você poderá carregar as representações de palavras aprendidas por três modelos bastante utilizados atualmente entre outros:

**word2vec**: `"word2vec-google-news-300"`

**fasttext**: `"fasttext-wiki-news-subwords-300"`

**glove**: `"glove-wiki-gigaword-50"`

Para mais opções de modelos pré-treinados e informações sobre os corpus em que foram treinados visite https://github.com/RaRe-Technologies/gensim-data

**Importe gensim**

Comece importando `gensim.downloader`
"""

# [INSIRA CÓDIGO AQUI]

"""**Carregue os modelos pré-treinados**

Utilize o método `.load('nome-do-modelo')` pertencente à `gensim.downloader`.

Modelos como `word2vec` e `fasttext`, treinados para aprenderem representações de vetores com até 300 dimensões acabam sendo mais pesados para carregar, principalmente neste ambiente do colab. A sugestão é que inicialmente você carregue um modelo menor e faça as explorações necessárias. Posteriormente, tente carregar esses modelos maiores.

Inicialmente carregue apenas o modelo do glove com vetores de 50 dimensões: `"glove-wiki-gigaword-50"`.

Faça a chamada do `downloader.load()` passando como parâmetro o nome do modelo. Espere até que o download termine.
"""

# [CARREGUE glove-wiki-gigaword-50]
# glove_vectors = gensim.downloader.load(?)

"""**DICA:** Carregue os outros dois modelos (Word2Vec e fasttext) apenas após a exploração da representação de palavras dos vetores glove.
O carregamento desses modelos pode acabar demorando, por isso a recomendação é carregar e explorar um por vez.
"""

# [CARREGUE word2vec-google-news-300]

# [CARREGUE fasttext-wiki-news-subwords-300]

"""# Visualizando a representação de palavras

Visualize o vetor de representação de algumas palavras.
Para isso, faça a chamada da variável que representa o modelo carregado e o atributo `.wv` que contém o vocabulário com representações vetoriais para cada palavra do corpus.

**Exemplo**
```
model.wv['uma-palavra-qualquer']
```

Nas versões mais recentes do Gensim é possível recuperar a representação das palavras apenas acessando o objeto armazenado pela variável modelo.

**Exemplo**
```
model['uma-palavra-qualquer']
```

Utilizando a funçao `.len()` é possível verificar o número de dimensões do vetor de representação da palavra.
"""

# [CÓDIGO AQUI]

"""Obtenha um ranking das palavras do corpus que são mais similares a alguma outra.

Isto é possível através da chamada do método `.most_similar("palavra")`. Utilize o atributo `topn=5`, para limitar o ranking a 5 palavras.

Exemplo:
```
Segundo as representações aprendidas pelo modelo Glove de 50 dimensões as 5 palavras mais similares a "computer" são:

[('computers', 0.9165046215057373),
 ('software', 0.8814994096755981),
 ('technology', 0.852556049823761),
 ('electronic', 0.812586784362793),
 ('internet', 0.8060455322265625)]

```

**Verifique e explore outras palavras.**
"""

# [CÓDIGO AQUI]

"""**Operações com embeddings**

```
woman + king - man = ?
```
Utilize a função `.most_similar(positive=[?], negative=[?], topn=1)` fazendo as devidas modificações para encontrar o resultado da operação acima.

Para o modelo glove de 50 dimensões o resultado dessa operação será: ``` queen: 0.8523```

**Experimente novas combinações de vetores de forma a encontrar palavras próximas semanticamente.**


"""

# [CÓDIGO AQUI]

"""**Plotando as representações**

Agora vamos visualizar a proximidade entre palavras utilizando um plano cartesiano 2D.

Devido ao grande número de dimensões das nossas representações (no caso do `'glove-wiki-gigaword-50'` temos 50 dimensões) precisamos fazer a redução de dimensionalidade de forma a conseguirmos mostrar esses pontos em um plot 2D ou 3D.

A principal técnica utilizado para redução de dimensionalidade é o Principal Component Analysis (PCA). No entando mais recentemente o t-Distributed Stochastic Neighbor Embedding (t-SNE) também tem sido amplamente utilizado.

**Importe as bibliotecas necessárias**:

Utilizaremos o PCA.
```
from sklearn.decomposition import PCA
```
"""

# [CÓDIGO AQUI]

"""Reduziremos as 50 dimensionalidades para 2, assim poderemos mostrar as representações em um plot 2D.

1. Obtenha a representação das palavras: computer, science, software, intelligence, internet, car, bike, truck. Atribua à variável `vetores`;
2. Faça a redução de dimensionalidade:
    
    `vetores_2d = PCA(random_state=0).fit_transform(vetores)[:,:2]`

"""

# [CÓDIGO AQUI]

"""**Importe a biblioteca para plotagem**: Utilizaremos matplotlib

Utilize o vetor de duas dimensões para preencher o código abaixo e fazer a plotagem. Substitua `?` pela respectiva variável.

O vetor `palavras` corresponde às palavras que tiveram as representações obtidas.

```
plt.figure(figsize=(5, 5))
plt.scatter(?[:,0], ?[:,1], linewidths=3, color='blue')
plt.xlabel("x", size = 10)
plt.ylabel("y", size = 10)
plt.title("Word Embedding Space", size = 20)

for i, word in enumerate(palavras):
  plt.annotate(word, xy = (?[i, 0], ?[i, 1]))
```

O plot deverá ficar conforme o exemplo abaixo:


![Screenshot from 2022-03-08 14-58-23.png](data:image/png;base64,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)
"""

# [COLOQUE O CÓDIGO AQUI]

"""**Visualize também as representações de palavras dos outros modelos (glove e fasttext)**"""

# [Visualize representações do glove]

# [Visualize representações do fasttext]

"""# Treinando modelos de representação de palavras em corpus específico

Os modelos pré-treinados no Gensim são em sua maioria treinados em corpus de lingua inglesa. Dessa forma iremos utilizar o gensim para treinar o modelo word2vec em um corpus em português. Para obtermos representações bastante significativas para a língua portuguesa precisaríamos de um corpus com uma grande variedade de documentos em português. Como o intuito desse exercício é apenas uma prática, iremos utilizar o conjunto de dados de teses e dissertações da CAPES utilizado na "Aula 1 - Text Processing".

A célula abaixo já faz o download e processamento inicial do dataset, você só precisa processar os dados presentes no dataframe retornado e utilizá-lo para treinar o modelo de representação de palavras word2vec.
"""

# Baixando o arquivo para o colab
!wget https://figshare.com/ndownloader/files/23855441

# perceba no log acima que o arquivo é um .zip ->[application/zip]
# portanto precisaremos descompactá-lo
!unzip 23855441

import pandas as pd

# o separador \t indica o formato de separação tab para arquivos .tsv
df = pd.read_csv("en_pt.tsv", sep="\t")

df.head()

"""**Preparando o conjunto de dados**


*   Você deverá dar como entrada ao Gensim apenas o corpus tokenizado. Sendo assim, selecione apenas a coluna `tgt_abs` do dataframe acima.
*   Utilizando o NLTK, tokenize os textos em português presentes na coluna `tgt_abs`.

OBS: Importando o NLTK para tokenização de textos em português

```
import nltk
from nltk.tokenize import word_tokenize
nltk.download('punkt')

texto_tokenizado = word_tokenize(texto_nlp, language='portuguese')
```





"""

# [ CÓDIGO AQUI ]

"""**Treine o modelo Word2Vec utilizando o Gensim e o conjunto de dados preparado anteriormente.**

Importando Word2Vec
```
from gensim.models import Word2Vec
```

Treinando o Word2Vec
```
modelo_treinado_capes = Word2Vec(texto_tokenizado, size = 100, window=5, min_count=1, workers=4)
```
Par maiores detalhes sobre os parâmetros consulte https://radimrehurek.com/gensim/models/word2vec.html#gensim.models.word2vec.Word2Vec
"""

# [CÓDIGO AQUI]

# [CÓDIGO AQUI]

"""**Para maiores detalhes sobre como salvar o modelo treinado e reutilizá-lo depois, visite https://radimrehurek.com/gensim/models/word2vec.html#**

# Utilizando a representação de palavras no treino de redes neurais

**Escolha e pré-processe um dos subconjuntos de dados de reviews da Amazon (https://nijianmo.github.io/amazon/index.html#subsets)**

A célula abaixo já faz o download e processamento inicial do subconjunto Amazon Fashion, você só precisa alterar o link de download pelo link do seu subconjunto escolhido.

Após o download da base e processamento inicial você estará com um dataframe contendo as reviews em texto em linguagem natural em uma coluna, e outra coluna contendo a avaliação em estrelas (1-5) atribuída ao produto pelo cliente que escreveu a review.
"""

# Baixando o subconjunto de reviews da Amazon.
!wget http://deepyeti.ucsd.edu/jianmo/amazon/categoryFilesSmall/AMAZON_FASHION_5.json.gz

# perceba qno log acima que o arquivo consiste de um json compactado
# portanto precisaremos descompactá-lo
!gzip -d AMAZON_FASHION_5.json.gz

import json

# carrega os objetos json para uma lista
reviews = []
for review in open("AMAZON_FASHION_5.json", "r"):
  reviews.append(json.loads(review))

# Cria um dataframe apenas com as informações necessárias para a tarefa
# no caso o texto da review e a avaliação do produto (dada em estrelas)
reviews_only = []
for r in reviews:
  if set(["reviewText", "overall"]).issubset(r.keys()):
    reviews_only.append({'review': r['reviewText'],
                        'rating': r['overall'], })

# cria um dataframe para facilitar a manipulação dos dados
reviews_df = pd.DataFrame(reviews_only)

# visualizar uma amostra dos dados
reviews_df.sample(5)

"""**Pré-processamentos adicionais**

* Precisamos codificar o texto em linguagem natural, substituindo os tokens por vetores de representação de palavras que foram aprendidos por algum modelo de representação de palavras.
   
  * Seguindo os passos anteriores, treine o modelo `Word2Vec` do `Gensim` **com a base da Amazon escolhida por você**. Utilize uma dimensão de `100` features.


"""

# [CÓDIGO AQUI]

"""**De posse do modelo `Word2Vec` treinado na base da Amazon, pré-processe seu conjunto de dados, codificando os tokens pelas representações aprendidas. Para agilizar os próximos passos aqui já é possível fazer um split na sua base, separando os valores de entrada (`X`) de seus respectivos labels (`y`). Também identifique qual o tamanho máximo (`max_len`) das reviews em sua base.**

OBS: Perceba que os labels de ratings (y) vão de 1 a 5. Para que não ocorra problema durante o treino da rede, transforme esses valores fazendo um pequendo "shift" colocando-os na escala de 0 a 4.
"""

# [CÓDIGO AQUI]

"""**Perceba que mesmo após codificar o texto, os documentos (reviews) possuem tamanhos diferentes, devendo portanto ser padronizados em um tamanho máximo (utilize o `max_len` descoberto no passo anterior). Para esse pré-processamento utilize a mesma ideia de padding aplicado nos exercícios da "Aula 2 - Intr. Redes Neurais"**

DICAS:
1.   Após o processamento anterior cada token de sua sentença é representado por um vetor de 100 dimensões
2.   Cada sentença tem um número de tokens (vetores de tokens) diferentes
3.   Você está trabalhando com uma lista de itens (de tamanho variado) onde cada item tem um tamanho fixo, portando você estará lidando com três dimensões:
```
(número de exemplos, número de tokens, dimensão do vetor de palavra)
```
Atualmente a sua dimensão `número de tokens` não tem um tamanho certo. Você deve aplicar padding de forma que `número de tokens = max_len`

4. Seu pré-processamento deverá resultar em um numpy array de shape
`(n_exemplos, max_len, 100)`

"""

# [CÓDIGO AQUI]

"""**Verifique o shape do seu conjunto de dados pré-processado.**

**Separe uma amostra de 30% dos seus exemplos para serem utilizados como conjunto de teste para avaliação do treino de sua rede neural.**

Utilize `train_test_split` do `sklearn` (https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)
"""

# [CÓDIGO AQUI]

"""**Projete, treine e avalie uma arquitetura básica de rede neural que deverá ser treinada a fim de predizer qual a avaliação (rating) de uma dada review.**

OBS: aplique os conhecimentos adquiridos nas aulas teóricas e práticas anteriores.

OBS 2: Perceba que esse trata-se de um problema de classificação multiclass e que com a utilização de word embeddings pré-treinados a entrada da sua rede deverá apresentar mais de uma dimensão.

OBS 3: Altere a arquitetura da rede como preferir, adicionando camadas densas e de dropout, treine e avalie.. mude número de neurônios das camadas e funções de ativação, epochs e batch_size de treino. Tente encontrar os melhores valores de loss e acurácia.
"""

# [CÓDIGO AQUI]

"""# [APLICAÇÃO] Fazendo a classificação de sentimento com uma arquitetura de rede recorrente


*   Carregamento do Dataset
*   Pré-processando os dados (Codificação textual)
*   Definição da Rede Neural utilizando camada embutida para embeddings de palavras e LSTM

Execute os códigos abaixo e após isso, faça alterações no treino de forma a avaliar as mudanças na performance do modelo. Altere parâmetros de treino, número de neurônios, inclua ou remova camadas na arquitetura da rede (tente incluir mais de uma camada LSTM).

"""

import numpy as np

import tensorflow_datasets as tfds
import tensorflow as tf

tfds.disable_progress_bar()

import matplotlib.pyplot as plt

def plot_graphs(history, metric):
  plt.plot(history.history[metric])
  plt.plot(history.history['val_'+metric], '')
  plt.xlabel("Epochs")
  plt.ylabel(metric)
  plt.legend([metric, 'val_'+metric])

"""## Carregando os dados"""

dataset, info = tfds.load('imdb_reviews', with_info=True,
                          as_supervised=True)
train_dataset, test_dataset = dataset['train'], dataset['test']

train_dataset.element_spec

for example, label in train_dataset.take(1):
  print('text: ', example.numpy())
  print('label: ', label.numpy())

BUFFER_SIZE = 10000
BATCH_SIZE = 64

train_dataset = train_dataset.shuffle(BUFFER_SIZE).batch(BATCH_SIZE).prefetch(tf.data.AUTOTUNE)
test_dataset = test_dataset.batch(BATCH_SIZE).prefetch(tf.data.AUTOTUNE)

for example, label in train_dataset.take(1):
  print('texts: ', example.numpy()[:3])
  print()
  print('labels: ', label.numpy()[:3])

"""## Utilizando encoder textual"""

VOCAB_SIZE = 1000
encoder = tf.keras.layers.TextVectorization(
    max_tokens=VOCAB_SIZE)
encoder.adapt(train_dataset.map(lambda text, label: text))

vocab = np.array(encoder.get_vocabulary())
vocab[:20]

encoded_example = encoder(example)[:3].numpy()
encoded_example

for n in range(3):
  print("Original: ", example[n].numpy())
  print("Round-trip: ", " ".join(vocab[encoded_example[n]]))
  print()

"""## Definindo a arquitetura da rede com uma camada embutida de embedding"""

model = tf.keras.Sequential([
    encoder,
    tf.keras.layers.Embedding(
        input_dim=len(encoder.get_vocabulary()),
        output_dim=64,
        # Use masking to handle the variable sequence lengths
        mask_zero=True),
    tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(64)),
    tf.keras.layers.Dense(64, activation='relu'),
    tf.keras.layers.Dense(1)
])

print([layer.supports_masking for layer in model.layers])

# predict on a sample text without padding.

sample_text = ('The movie was cool. The animation and the graphics '
               'were out of this world. I would recommend this movie.')
predictions = model.predict(np.array([sample_text]))
print(predictions[0])

# predict on a sample text with padding

padding = "the " * 2000
predictions = model.predict(np.array([sample_text, padding]))
print(predictions[0])

# Compilando a arquitetura da rede
model.compile(loss=tf.keras.losses.BinaryCrossentropy(from_logits=True),
              optimizer=tf.keras.optimizers.Adam(1e-4),
              metrics=['accuracy'])

"""## Treinando o Modelo"""

history = model.fit(train_dataset, epochs=10,
                    validation_data=test_dataset,
                    validation_steps=30)

test_loss, test_acc = model.evaluate(test_dataset)

print('Test Loss:', test_loss)
print('Test Accuracy:', test_acc)

plt.figure(figsize=(16, 8))
plt.subplot(1, 2, 1)
plot_graphs(history, 'accuracy')
plt.ylim(None, 1)
plt.subplot(1, 2, 2)
plot_graphs(history, 'loss')
plt.ylim(0, None)

sample_text = ('The movie was cool. The animation and the graphics '
               'were out of this world. I would recommend this movie.')
predictions = model.predict(np.array([sample_text]))